#!/bin/sh

# Setting Vars
FILE=$(basename "$1")
EXTENSION=$(echo "$FILE" | awk -F . '{if (NF>1) {print $NF}}')
BASE=$(basename "$FILE" ."$EXTENSION")


# Filter to compiler Suckless Utilites
case $FILE in
	config.h.def)
		doas make clean install ; make clean
		;;
	config.h)
		doas make clean install ; make clean
		;;
esac

# Filter to compile other types of files
case $EXTENSION in
	# Markdown
	*md)
	DOCUMENT=$(printf "pdf_document\nhtml_document\nbeamer_presentation" | dmenu -i -p "Format:") && R -e "rmarkdown::render('$FILE', '""$DOCUMENT""')"
	;;
	# Groff
	ms)
	groff -k -T pdf -m -ms "$FILE" > "$BASE.pdf"
	;;
	# Java
	java)
	javac "$FILE"
esac
