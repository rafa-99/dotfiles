#!/bin/sh

# Setting Vars
FILE=$(basename "$1")
EXTENSION=$(echo "$FILE" | awk -F . '{if (NF>1) {print $NF}}')
BASE=$(basename "$FILE" ."$EXTENSION")


# Filter to compiler Suckless Utilites
case $FILE in
	config.h.def)
		doas make clean install ; make clean
		;;
	config.h)
		doas make clean install ; make clean
		;;
esac

# Filter to compile other types of files
case $EXTENSION in
	md|rmd) # Markdown
		DOCUMENT=$(printf "pdf_document\nhtml_document\nbeamer_presentation" | dmenu -i -p "Format:") && R -e "rmarkdown::render('$FILE', '""$DOCUMENT""')"
		;;
	ms) # Groff
		groff -k -T pdf -m -ms "$FILE" > "$BASE.pdf"
		;;
	java) # Java
		java "$FILE"
		;;
	c|h) # C
		FILES=$(find . -name '*.h' -o -name '*.c' | cut -d/ -f2)
		gcc -o "$BASE" "$FILES"
		;;
	*)
		echo "File Type Not Found X("
esac
